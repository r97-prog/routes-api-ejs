<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Adduser page</title>
</head>
<body>

  <h1><i>Add user</i></h1> 
      <form action="/adduser" method="POST">
        <label for="name">fullName:</label><br>
        <input type="text" name="fullName" value="" id="fullName">
        <span id="validName" class=""></span><br><br>
   
        <label for="email">Email:</label><br>
        <input type="text"  name="email" value="" id="email">
        <br><br>
        <span id="validEmail" class=""></span><br>
    
        <label for="password">Password</label><br>
        <input type="password"  name="password" value="" id="password">
        <br><br>
        <span id="validpassword" class=""></span><br>
           
        <label for="confirmPass">confirmPass</label><br>
        <input type="password"  name="confirmPass" value="" id="confirmPass">
        <br><br>
        <span id="confirmvalidPassword" class=""></span><br>
        <button type="button"class="btn btn-info" onclick="saveData()">Submit</button>    
    </form>

    <script>
   function validation(){
        var fullName = document.getElementById('fullName').value
        var email = document.getElementById('email').value
        var password = document.getElementById('password').value
        var confirmPass = document.getElementById('confirmPass').value
        var emailformat = /^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/;

        if(fullName == ""){
          document.getElementById('validName').innerHTML = "Please fill name field"
          return false;
        }else if(email == ""){
          document.getElementById('validName').innerHTML = ""
          document.getElementById('validEmail').innerHTML = "please fill email field"
          return false;
        }else if(!emailformat.test(email)){
          document.getElementById('validEmail').innerHTML = ""
          document.getElementById('validEmail').innerHTML = "please fill correct Email"
          return false;
        }else if(password == ""){
          document.getElementById('validEmail').innerHTML = ""
          document.getElementById('validpassword').innerHTML = "Please fill password"
          return false;
        }else if(password.length<6){
          document.getElementById("validpassword").innerHTML = "Password must be 6 character"
          return false;
        }
        else if(confirmPass == ""){
          document.getElementById('confirmvalidPassword').innerHTML = "Please fill confirm password"
          return false;
        }
        else if(password!==confirmPass){
          document.getElementById('validpassword').innerHTML = ""
          document.getElementById('confirmvalidPassword').innerHTML = "Password and confirm password must be same"
          return false;
        }else{
          document.getElementById('confirmvalidPassword').innerHTML = ""
          return true;
        }
            }

    function saveData(){
      console.log();
      if(validation() === true){
        let params = {
      "fullName" : fullName.value,
      "email" :email.value,
      "password" : password.value,
      "confirmPass":confirmPass.value
    }
let button = document.getElementsByTagName('button');
const  xhttp = new XMLHttpRequest();
      xhttp.onreadystatechange = function(){
        if(this.readyState===4 && this.status === 200) {
          let response = JSON.parse(this.response);
          console.log(response)
          window.location.pathname="/users"
      }
    };
    xhttp.open("POST","/adduser",true);
      xhttp.setRequestHeader("Content-type", "application/json");
      xhttp.send(`${JSON.stringify(params)}`)
  } else {
    validation();
  }
}
    </script>
</body>
</html>